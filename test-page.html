<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BetterGPT Test Page</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 40px 20px;
            line-height: 1.6;
        }
        h1 {
            color: #333;
            border-bottom: 2px solid #007bff;
            padding-bottom: 10px;
        }
        .section {
            margin: 30px 0;
            padding: 20px;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            background: #f9f9f9;
        }
        .section h2 {
            margin-top: 0;
            color: #007bff;
        }
        button {
            padding: 10px 20px;
            margin: 5px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
        }
        button:hover {
            background: #0056b3;
        }
        .output {
            margin-top: 15px;
            padding: 15px;
            background: white;
            border: 1px solid #ddd;
            border-radius: 4px;
            min-height: 100px;
            white-space: pre-wrap;
            font-family: 'Courier New', monospace;
            font-size: 13px;
        }
        .info {
            background: #e3f2fd;
            border-left: 4px solid #2196f3;
            padding: 15px;
            margin: 20px 0;
        }
        .kbd {
            background: #f4f4f4;
            border: 1px solid #ccc;
            border-radius: 3px;
            padding: 2px 6px;
            font-family: monospace;
            font-size: 13px;
        }
    </style>
</head>
<body>
    <h1>BetterGPT Test Page</h1>
    
    <div class="info">
        <strong>Instructions:</strong>
        <ol>
            <li>Load the extension in Chrome: Go to <code>chrome://extensions/</code></li>
            <li>Enable "Developer mode"</li>
            <li>Click "Load unpacked" and select the <code>dist/</code> folder</li>
            <li>Reload this page</li>
            <li>Press <span class="kbd">Ctrl+Shift+A</span> to toggle the BetterGPT UI</li>
        </ol>
    </div>

    <div class="section">
        <h2>UI Tests</h2>
        <p>Test the extension UI and keyboard shortcuts:</p>
        <button onclick="testToggleUI()">Toggle UI (Ctrl+Shift+A)</button>
        <button onclick="testShowUI()">Show UI</button>
        <button onclick="testHideUI()">Hide UI</button>
        <div id="ui-output" class="output">UI test results will appear here...</div>
    </div>

    <div class="section">
        <h2>Database Tests</h2>
        <p>Test IndexedDB and conversation storage:</p>
        <button onclick="testSaveConversation()">Save Test Conversation</button>
        <button onclick="testGetConversations()">Get All Conversations</button>
        <button onclick="testCreateFolder()">Create Test Folder</button>
        <button onclick="testGetFolders()">Get All Folders</button>
        <button onclick="testClearDatabase()">Clear Database</button>
        <div id="db-output" class="output">Database test results will appear here...</div>
    </div>

    <div class="section">
        <h2>Integration Tests</h2>
        <p>Test conversation management features:</p>
        <button onclick="testArchive()">Archive Conversation</button>
        <button onclick="testFavorite()">Favorite Conversation</button>
        <button onclick="testSearch()">Search Conversations</button>
        <button onclick="testBulkOperations()">Test Bulk Operations</button>
        <div id="integration-output" class="output">Integration test results will appear here...</div>
    </div>

    <div class="section">
        <h2>Extension Status</h2>
        <button onclick="checkExtensionStatus()">Check Extension Status</button>
        <div id="status-output" class="output">Extension status will appear here...</div>
    </div>

    <script>
        // UI Tests
        function testToggleUI() {
            chrome.runtime.sendMessage({ type: 'TOGGLE_UI' }, (response) => {
                document.getElementById('ui-output').textContent = 
                    'Toggle UI response: ' + JSON.stringify(response, null, 2);
            });
        }

        function testShowUI() {
            document.getElementById('ui-output').textContent = 
                'Show UI: Press Ctrl+Shift+A to show the UI panel on the right side';
        }

        function testHideUI() {
            document.getElementById('ui-output').textContent = 
                'Hide UI: Press Ctrl+Shift+A again to hide the UI panel';
        }

        // Database Tests
        async function testSaveConversation() {
            const output = document.getElementById('db-output');
            output.textContent = 'Testing save conversation...';
            
            try {
                // This would normally be done through the extension
                output.textContent = 'Save conversation test initiated.\nCheck browser console for details.';
                console.log('Test: Saving a conversation to IndexedDB');
            } catch (error) {
                output.textContent = 'Error: ' + error.message;
            }
        }

        async function testGetConversations() {
            const output = document.getElementById('db-output');
            output.textContent = 'Getting conversations...';
            
            try {
                output.textContent = 'Get conversations test initiated.\nCheck browser console for details.';
                console.log('Test: Retrieving all conversations from IndexedDB');
            } catch (error) {
                output.textContent = 'Error: ' + error.message;
            }
        }

        async function testCreateFolder() {
            const output = document.getElementById('db-output');
            output.textContent = 'Creating test folder...';
            
            try {
                output.textContent = 'Create folder test initiated.\nCheck browser console for details.';
                console.log('Test: Creating a folder in IndexedDB');
            } catch (error) {
                output.textContent = 'Error: ' + error.message;
            }
        }

        async function testGetFolders() {
            const output = document.getElementById('db-output');
            output.textContent = 'Getting folders...';
            
            try {
                output.textContent = 'Get folders test initiated.\nCheck browser console for details.';
                console.log('Test: Retrieving all folders from IndexedDB');
            } catch (error) {
                output.textContent = 'Error: ' + error.message;
            }
        }

        async function testClearDatabase() {
            const output = document.getElementById('db-output');
            const confirmed = confirm('Are you sure you want to clear the database?');
            
            if (confirmed) {
                output.textContent = 'Clearing database...\nCheck browser console for details.';
                console.log('Test: Clearing IndexedDB');
            } else {
                output.textContent = 'Database clear cancelled.';
            }
        }

        // Integration Tests
        function testArchive() {
            const output = document.getElementById('integration-output');
            output.textContent = 'Archive test: This would archive a conversation.\nCheck browser console for details.';
            console.log('Test: Archive conversation');
        }

        function testFavorite() {
            const output = document.getElementById('integration-output');
            output.textContent = 'Favorite test: This would favorite a conversation.\nCheck browser console for details.';
            console.log('Test: Favorite conversation');
        }

        function testSearch() {
            const output = document.getElementById('integration-output');
            output.textContent = 'Search test: This would search conversations.\nCheck browser console for details.';
            console.log('Test: Search conversations');
        }

        function testBulkOperations() {
            const output = document.getElementById('integration-output');
            output.textContent = 'Bulk operations test: This would perform bulk operations.\nCheck browser console for details.';
            console.log('Test: Bulk operations');
        }

        // Extension Status
        function checkExtensionStatus() {
            const output = document.getElementById('status-output');
            output.textContent = 'Checking extension status...';
            
            chrome.runtime.sendMessage({ type: 'PING' }, (response) => {
                if (chrome.runtime.lastError) {
                    output.textContent = 'Extension not loaded or error:\n' + 
                        chrome.runtime.lastError.message;
                } else {
                    output.textContent = 'Extension is loaded!\n\n' + 
                        'Response: ' + JSON.stringify(response, null, 2) + '\n\n' +
                        'Content script should be initialized.\n' +
                        'Press Ctrl+Shift+A to toggle the UI.';
                }
            });
        }

        // Check extension status on page load
        window.addEventListener('load', () => {
            setTimeout(checkExtensionStatus, 1000);
        });
    </script>
</body>
</html>
